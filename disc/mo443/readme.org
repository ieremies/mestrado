#+Title: MO443 - Processamento de Imagem Digital
#+Subtitle: Prof. Helio
#+category: mo443
#+Options: toc:nil num:nil date:nil tags:nil
#+LATEX_CLASS_OPTIONS: [twocolumn, 10pt]
#+COLUMNS: %25ITEM %TODO %EFFORT{+}

[[https://www.ic.unicamp.br/~helio/][Helio Pedrini's Homepage]]

* Slides [50%]
** DONE Introdução
** TODO Fundamentos
:PROPERTIES:
:EFFORT:   103
:END:
Amostragem discretiza o espaço e quantização diz o número de níveis de cinza.

Precisamos de uma amostra a cada 1/2B onde 2B é o tamanho da banda [-B, B] (limite de nyquist).
Caso não seja usado uma frequência de banda suficientemente larga, sinais com frequência alta são reconstruídos com frequências baixas causando *aliasing*.

Resolução espacial tem a ver com o quanto de espaço real um pixel representa.
** TODO Realce
:PROPERTIES:
:EFFORT:   143
:END:
** TODO Filtragem em frequência
:PROPERTIES:
:EFFORT:   121
:END:

*** Fundamentos
Sinal :: representação de um fenômeno a partir da variação de características físicas ao longo do tempo ou espaço
Tipos de sinais:
- contínuos ::  estados são definidos ininterruptamente
- discretos :: estados definido em instantes específicos
- analógicos :: estados podem assumir qualquer valor real ou complexo
- digitais :: estados podem assumir um subconjuntod e valores discretos enumeráveis

Sinais analógicos podem ser convertidos em sinais digitais a partir da amostragem, quantização e codificação.
Na amostragem, o espaço (tempo) de amostragem é dividido em partes discretas. Na quantização há a aproximação do valor de amplitude ao conjunto finito de possibilidades. Codificação corresponde à correlação de tais níveis a um código.

*** Transformadas de imagens
Operações que alteram o espaço de representação de uma imagem para outro domínio de forma que:
- a informação presente na imagem seja preservada no domínio da transformada
- a transformada seja reversível

Um exemplo destas é a transformada de Fourrier

*** Amostragem
representação de um sinal contínuo por um número finito de valores

*Teorema da amostragem* é possível rescontruir um sinal (de banda limitada) contínuo  a partir de suas amostras se a frequência de amostragem exceder duas vezes a largura da banda.

*Transformada discreta de Fourier* (DFT) converte um conjunto finito de N amostras uniformemente espaçadas numa função de senoidais complexas.

*** Convolução
To entendendo nada, as parece ser a soma dos sinais, um vindo da esquerda pra direita e outro da direita para esquerda.
** DONE Segmentação :ATTACH:
CLOSED: [2023-05-16 Tue 15:06]
:PROPERTIES:
:EFFORT:   130
:ID:       3dcbe9d4-8b2b-4e9d-a16c-58de824c3af1
:END:
Particionar o conjunto de dados em estruturas com conteúdo semântico -> após determinarmos os objetos, caracterimo-nos por meio de suas propriedades.

Os métodos se baseam nas descontinuidades (mudanças abruptas) e similaridades.

Detectar pontos pode ocorrer por meio da máscara
[[attachment:_20230510_211241screenshot.png]]
Para segmentos de reta, fazemos algo similar só que com um traço em diversas direções.

*** Detecção de bordas :ATTACH:
Podemos fazê-la a partir do entendimento da mudança brusca nos níveis de cinza, observando a primeira e segunda derivadas.

Assim, podemos também utilizar o conceito de gradiente, dada a natureza $\mathbb{Z}^2$ das imagens.
A direção do gradiente, quando sua maginitude é suficientemente grande, indica a orientação da borda do objeto.
Podemos obter uma aproximação suficientemente descente da magnitude do gradiente somando a derivada em cada direção ou pegando a maior delas.
Já do ângulo, tiramos o $arctan(\frac{g_x}{g_y})$.
Exsitem diversas máscara que aproximam o gradiente.

*** Laplaciano
$\triangledown^2$
Operador que pode ser utilizado no gradiente e é aproximado por uma máscara 3x3 na qual o pixel central é positivo e todos os outros negativos. Idealmente, os mais próximo possuem valores ainda maiores.

*** Laplaciano do gaussiano e diferença do gaussiano :ATTACH:
As derivadas segundas são sensíveis a ruídos.
Podemos reduzi-los aplicando um filtro gaussiano e, posteriormente, detectamos bordas pelo cruzamento em zero da segunda derivada e um pico significativo na primeira.

Resolvendo a equação do laplaciano do gaussiano, temos uma função que parece um chapeu mexicano invertido.

[[attachment:_20230514_194521screenshot.png]]
Há evidências que o olho faz algo similar.

Ele pode ser aproximado pela convolução de uma máscara que é a diferença entre duas funções Gaussianas com valores de $\sigma$ significativamente diferentes.
*** Canny
- Gaussiano
- computa-se a magnitude e direção do gradiente a partir das derivadas parciais
- borda é pontos cuja magnitude seja localmente máxima na direção do gradiente (supressão não máxima)
- Usa-se um limiar para remover os fragmentos expúrios
*** Boie e Cox
Similar ao Canny, mas usam o cruzamento do zero na derivada segunda.
*** Transformada de Hugh
Técnica para determinar se uma curva passa por um certo conjunto de pontos.
Para retas, usamos o fato que a reta deve possuir os mesmos coeficientes angulares e lineares, ou fazemos isso usando coordenadas polares, onde $\rho$ é a distância da origem à reta e $\theta$ é o ângulo.
O espaço ($\rho$, $\theta$) chamado espaço de Hough, pontos colineares no espaço (x,y) correspondem a curvas senoidais que se interceptam.

Para implementa-lo, discretizamos o espaço $(\rho,\theta)$ e cada célula do espaço é considerada uma célula de acumulação.
Testamos várias combinações e somamos baseado na quantidade de pontos colineares para tais combinações.
Picos são usados para determinar segmentos reais na imagem.

Útil para várias retas, já que apresentaram-se na forma de diversos picos e é insensível a ruídos e descontinuidades, já que estes representaram apenas uma redução do máximo local.
O problema é na detecção de formas com mais parâmetros, o que aumenta a computação necessária -> podemos reduzir isso usando o gradiente das curvas.

O mesmo é feito para circunferências. Já para formas em geral, utilizamos a ideia de manter uma tabela de distãncia e ângulo de cada ponto da forma e utilizamos a ideia de acumulção da mesma forma.
*** Limiarização
Classsificação dos pixels baseado num limiar que os separada em objeto e fundo.
No caso global, toda a imagem obedece o mesmo valor, no caso local, este é calculado baseado numa janela da imagem, o que é severamente influenciado pelo tamanho da janela.

No método global, uma forma é tentar minimizar o erro da distribuição da gaussianas que definem o histograma dos pixels.

*** Segmentação de regiões
a. Cada pixel deve pertencer a uma região da imagem
b. Pixels satisfazem critérios de conectividade
c. Regiões devem ser disjuntas
d. Pixels de uma certa região devem satisfazer uma propriedade
e. Regiões adjacentes devem diferer em tal propriedade

Técnicas:
- Crecimento de regiões :: Agrega pixels com propriedades similares e, portanto, precisa de pixels sementes de onde começar
- Segmentação de regiões :: começamos de uma grande região com a imagem inteira e vamos dividindo (quadtree).

** DONE Representação e descrição
CLOSED: [2023-05-09 ter 15:17]
:PROPERTIES:
:EFFORT:   79
:END:
Um objeto pode ser descrito por suas características externas (bordas) ou internas (pixels que compõem).
Para descrevê-lo, precisamos de uma forma que seja pouco afetado pela presença de ruído.
# Algo que parece importante dessa parte é saber se cada técnica é invariante à rotação, translação e mudança de escala

*** Esquemas de representação
**** Freeman - código da cadeia
cada número representa a direção do próximo pixel da borda (zero é sempre pra direita, crescendo no sentido horário).
Ele varia conforme o pixel inicial, mas podemos normalizar encontrando o menor número inteiro que o represente.
Para torná-lo invariante com a mudança de escala, a borda pode ser reamostrada em uma grade de espamaento conveniente.
Diferença no código da cadeia é a soma das diferenças entre cada dígito e o próximo (mod vizinhança).
Uma mesma borda rotacionada possui a mesma diferença no código da cadeia independente da horientação, o que caracteriza o mesmo objeto.
Vantagens: redução do espaç de armazenamento
Desvantagem: sensibilidade a pequenas perturbações ao longo da borda.
**** Polígonos
Representamos a forma a partir de um polígono, dado uma precisão.
Em cortonos fechados, podemos torna-la exata se a quantidade de vértices for igual ao número de pontos na borda.
Isso pode ser caro, mas tem certas técnicas para aproximar em tempo aceitável.
Uma forma de fazer a borda é dividir em segmentos, toda vez que a distância perpendicular exceder o erro aceitável, esse ponto torna-se um novo vértice.
**** Assinatura :ATTACH:
:PROPERTIES:
:ID:       f79cc512-7365-4853-9fe5-ec45714f0f10
:END:
Função de onda da distância do centro a borda

[[attachment:_20230508_204328screenshot.png]]
Invariante em relação a tranlação, mas precisamos determinar um ponto inicial para ser indiferente a rotação ou normalizar os vetores para obter a invariância em relação à escala.
**** Fecho convexo
Menor polígono convexo que abrange o objeto
**** Esqueleto de um objeto
- ponto médio: conjuntos de pontos que equidistam de bordas (baseado nas maiores esferas)
- transformada de distância: mapa da distância entre cada ponto interior, valores mais altos formam o esqueleto
- diagrama de voroni: para uma forma de n vértices, repartimos o plano em n subconjuntos tais que os pontos interiores daquele conjunto estão mais próximos do que de qualquer outro ponto.
*** Técnicas de afinamento
Técnicas de afinamentos devem se atentar a não torna-lo desconexo ou causa erosão excessiva.
**** Zhang e Suen:
um pixel é removido se
- tem mais que um e menos que 7 vizinhos,
- se o número de transições de branco para preto na vizinhança ordenada é 1
- se ao menos um dos pixels cima direita baixo é fundo
- se ao menos um dos pixels direita baixo esquerda é fundo
Depois repetimos o processo, só que agora nas útlimas duas instruções usamos baixo esquerda cima e esquerda cima direita.
Repetimos tudo até não haver mais remoções.

**** Holt
Refina o método de Zhang: passos de zhang removendo serrilhamento a partir da percepção de que pixels que formam uma escada pode ser removidos sem quebrar a conectividade do objeto.
**** Stentiford e Mortimer
Quatro máscaras 3x3 com 0 1 1 no meio em cada uma das direções.
Um ponto final é um ponto que só possui um pixel preto como vizinho, este não pode ser removido.
*** Descritores de borda :ATTACH:
:PROPERTIES:
:ID:       cdb63161-ae5d-4537-acf6-00aeb54f3428
:END:
- Diâmetro :: a maior distância entre dois pontos da borda.
- Perímetro :: o número de pixels na borda.
- Curvatura :: a medida do angulo de dois segmentos de reta da borda (arctg).
- Energia de deformação ::
[[attachment:_20230509_151257screenshot.png]]
*** Descritores de região
- Área :: a soma dos pixels 1 ou pela soma abaixo
[[attachment:_20230509_144318screenshot.png]]
- Compacidade :: o quadrado do perímetro dividido pela área, o círculo possui a menor compacidade
- Projeções horizontal e vertical :: para um pixel (x,y) a projeção horizontal é a soma dos pixels na linha y (respc para vertical)
- Propriedades topológicas :: O número de buracos ou componentes conexas são propriedades invariantes das formas.
  O número de Euler é dado como E = C - H (conexas - buracos) também é uma propriedade topológica
- eixo maior :: o comprimeto do maior segmento de reta (respc menor).
- excentricidade :: o comprimento do maior dividido pelo menor.
- Retângulo envolvente :: o retângulo de menor dimensões que envolve o objeto bidimensional e cujos lados são paralelos aos eixos.
- Convexidade :: mede o grau ocm que o um objeto difere de um objeto convexo, pode ser dada pelo perímetro convexo dividido pelo perímetro real (o valor será 1 para o bjetos convexos).
- Retangularidade :: a área do objeto dividido pela área do retângulo envolvente.
- Solidez :: mede a densidade de um objeto, área do objeto dividio pela área do fecho convexo (1 para sólidos e menor que 1 para objetos com bordas irregulares ou buracos).
**** TODO Momento
*** Sintáticos ou relacionais
...
** DONE Morfologia matemática
CLOSED: [2023-05-09 ter 17:42]
:PROPERTIES:
:EFFORT:   88
:END:
Contrução de opearadores para descrição de objetos.
*** Fundamentos matemáticos
Teoria de conjuntos $\{(x,y) | f(x,y) = 1\} \in \mathbb{Z}^2$, ou seja, conjunto dos pontos 1.
Assim definimos própriamente união, intersecção, translação  ($A + p = \{a + p | a \in A\}$), reflexão ($\{-a | a \in A\}$), complemento e diferença.
Operador morfológico: mapeamento entre um conjunto A que define uma imagem e um conjunto B, chamado de elemento estruturante.

- Adição de Minkowski (dilatação) :: $\oplus$ para cada ponto da imagem, carimbamos o B. (comutativa, associativa).
- Subtração de Minkowski (erosão) :: $\ominus$ para cada ponto da imagem, se o B cabe inteiro, a origem é marcada.
É importante marcar que, para as duas operações, os elementos da primeira imagem não estão necessáriamente contidos, qunado dizemos "carimbar", referimos a colocar na imagem resultante que inicialmente é vazia.

As propriedades de associatividade e distributividade podem nos ajudar a reduzir os elementos estruturantes à componentes menores.
- Abertura :: (círculo vazio) de A por B é denotada por $(A \ominus B) \oplus B$ -> parte estreitas são removidas
- Fechamento :: (circulo preenchido) de A por B é denotoda $(A \oplus B) \ominus B$ -> buracos são preenchidos
- Acerto-ou-erro :: de A por B_1 e B_2 é definida por $A\circledast (B_1, B_2) = (A \ominus B) \cap (A^c \ominus B_2)$, ou seja, o resultante possui todos os pontos nos quais B_1 coincide com A e não coincide nenhum com B_2
  # TODO eu não entendi esse exemplo [[pdf:slides/aula_morfologia.pdf::41][aqui]]

Usaremos tais operadores para extrair características de objetos
**** Extração de borda
$E(A) = A - (A \ominus B)$, já que a erosão vai deixar só os pixels de dentro (gradiente interno), é como se eu tivesse marcando a borda por dentro.
Ou $E(A) = (A \oplus B) - A$, já que a dilatação vai crescer um pouco o objeto (gradiente externo), é como se eu estive marcando a borda por fora.
Ou $E(A) = (A \oplus B) - (A \ominus B)$, que é a soma dos dois anteriores (gradiente morfológico).
**** Preenchimento de regiões
Fazemos a dilatação a partir de um ponto semente dentro do objeto. A cada iteração dilatamos mais, mas também tiramos os elementos que pertencem à borda, para que não ultrapassemo-na.
**** Extração de componentes conexos
Fazemos a dilatação a partir de uma semente e retiramos todos que não estão em A. Assim, quando não há mais mudança, é porque percorremos todos os pixels conectados destes componente.
**** Fecho convexo :ATTACH:
:PROPERTIES:
:ID:       1e8bdef7-069f-41c6-b41d-bd15874a1a41
:END:
Sejam B_1, B_2, B_3 e B_4, o processo consiste em realizar a o acerto-ou-erro para B_1 afim de formar D_1 e assim respectivamente para os demais. O fecho convexo é a união dos D_i.
[[attachment:_20230509_172345screenshot.png]]

**** TODO Afinamento e espessamento
Afinamento :: $A \otimes B = A - (A \circledast B)$, em que $B = (B_1, B_2)$ distintos.
Espessamento :: $A \otimes B = A \cup (A \circledast B)$, em que $B = (B_1, B_2)$ distintos.
**** TODO Extração do esqueleto
**** Imagens monocromáticas :ATTACH:
:PROPERTIES:
:ID:       1aba1cf8-500e-4d3f-af12-f47ec39417a3
:END:
Para imagens monocromáticas, operamos com valores de intensidade.
Na dilatação, aplica-se a translação do elemento estruturante sobre todas as posições da imagem e para cada uma os valores do elemento estruturantes tomando-se o máximo.
A erosão é similar, tomando-se o mínimo. Vale mencionar que colocamos o valor final na origem.

A abertura e fechamento podem ser modificados a partir disso. A visão geométrica na qual ordenamos o os pixels e a altura é a intensidade.
[[attachment:_20230509_173600screenshot.png]]
**** Realce de contraste
- top-hat :: a diferença entre a imagem e sua abertura
- botton-hat :: a diferença seu fechamento e imagem.

Podemos realçar o contraste da imagem somando a ela o top-hat e subtriando depois o botton-hat.
O borramento pode ser reduzido a partir da substituição do pixel original pelo pixel correspondente na abertura ou fechamento, o que estiver mais próximo do original.
**** Granulometria
Estimativa da distribuição dos tamanhos dos objetos.
Podemos fazê-lo contando o número de componentes conexos após cada operação de abertura (progressivamente removendo os elementos em ordem crescente de tamanho).
**** Atenuação de ruído
Podemos atenuar o ruído sal e pimenta com operações sucetivas de abertura e fechamento.

** TODO Lista 1
DEADLINE: <2023-05-15 Mon>
1. Podemos diferentes diagramas para cada cor coponente da imagem (RGB) ou estabelecer alguma relação entre os valores das 3 cores e um número, como a soma ou composição de um inteiro.
2. Filtro da média suaviza a imagem e elimina altas frequências, já a mediana exarceba diferenças entre regiões.
3. As 4 características principais do filtro gaussiano são suficientes para mostrar que ele é bom para suavizar (separabilidade, simétrico, alguma coisa do desvio padrão, controle).
4. -
5. Detectar mudanças brucas, não sofrer grandes alterações com ruído e detectar mudanças na direção desejada, evitar descontinuidades, fina e contínua, evitar fragmentos expúrios, eficiente.
6. Profundidade: quantidade de bits para cada pixels.
   Resolução espacial: quantidade de detalhes do ambiente.
7. está conectado, 9 componentes na vizinhança-4 e 4 na vizinhança-8
8. O gradiente indica a direção e frequência com a qual a intensidade da imagem está mudando. Valores maiores indicam mudanças bruscas, o que indica bordas no sentido perpendicular a direção do gradiente.
9. ??????
10. -
11. -
12. -
13. A entropia é uma medida da quantidade de informações contidas na imagem que se baseia na probabilidade de cada valor de intensidade aparecer. Quanto mais espalhada em cada valor possível, maior a entropia.
14. Tais operações são utilizadas na erosão e abertura de objetos, bem como detecção de bordas e preenchimento.
15. A amostragem define as linhas e colunas e está relacionado
16. Por ser derivado de segunda ordem ele é sucetivo a ruído.
17. ????
18. A(s) bin(s) com maior quantidade
19. -
20. Dois vetores que multiplicadas dão a matriz que queremos. Se for possível, temos que é separavel

Um filtro passa alta retorna zero numa região homogênea
Na convolução o Kernel tem que sofrer uma rotação de 180 (??)


* Provas
** P1
DEADLINE: <2023-05-17 Wed>
** P2
* Trabalhos
** DONE Trabalho 1
CLOSED: [2023-04-23 Sun 21:20]
** DONE Trabalho 2
CLOSED: [2023-05-10 Wed 21:03] DEADLINE: <2023-05-05 sex>
** TODO Trabalho 3
DEADLINE: <2023-05-26 Fri>
